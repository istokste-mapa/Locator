<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lok√°tor Slu≈æieb üß≠</title>
    <style>
        /* Z√°kladn√© ≈°t√Ωly */
        body {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding-top: 5vh;
            font-family: Arial, sans-serif;
            background-color: #f4f7f6;
            text-align: center;
        }

        .container {
            padding: 20px;
            width: 100%;
            max-width: 450px;
        }

        h1 {
            color: #333;
            margin-bottom: 30px;
        }

        .button-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        /* V≈°eobecn√Ω ≈°t√Ωl pre v≈°etky tlaƒçidl√° */
        .action-button {
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            color: white;
            background-color: #1a73e8; /* Default modr√° */
            border: none;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease, transform 0.1s;
        }
        
        /* ≈†pecifick√© farby pre kateg√≥rie */
        .action-button.restaurants { background-color: #ea4335; } /* ƒåerven√° - Re≈°taur√°cie */
        .action-button.museums { background-color: #fbbc04; }    /* ≈Ωlt√° - Pamiatky */
        .action-button.rentals { background-color: #34a853; }    /* Zelen√° - Po≈æiƒçovne */
        .action-button.groceries { background-color: #4285f4; }   /* Modr√° - Potraviny */
        .action-button.parking { background-color: #7047a1; }     /* Fialov√° - Parkovisko */
        .action-button.lodging { background-color: #a728b9; }     /* Fialov√° - Ubytovanie (Nov√©) */
        .action-button.camping { background-color: #38b2ac; }     /* Tyrkysov√° - Kempy (Nov√©) */

        .action-button:hover { opacity: 0.9; }
        .action-button:active { transform: scale(0.98); }

        .status-message {
            color: #333;
            font-size: 14px;
            min-height: 20px;
            margin-top: 30px;
        }
        
        .error-message {
            color: #ea4335;
            font-weight: bold;
        }

        .pwa-tip {
            margin-top: 40px;
            padding: 15px;
            background-color: #fff;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-size: 12px;
            color: #555;
            line-height: 1.4;
        }
        .pwa-tip strong {
            display: block;
            margin-bottom: 5px;
            color: #1a73e8;
            font-size: 14px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Vyhƒæada≈• v okol√≠</h1>

        <div class="button-group">
            <button class="action-button restaurants" onclick="findPlaces('restaurants')">
                üçΩÔ∏è Re≈°taur√°cie
            </button>
            <button class="action-button museums" onclick="findPlaces('museums and historical places')">
                üèõÔ∏è Pamiatky a M√∫ze√°
            </button>
            <button class="action-button rentals" onclick="findPlaces('car rental, bike rental, scooter rental')">
                üöó Po≈æiƒçovne
            </button>
            <button class="action-button groceries" onclick="findPlaces('groceries and supermarkets')">
                üõí Potraviny a Obchody
            </button>
            <button class="action-button parking" onclick="findPlaces('parking lots and garages')">
                üÖøÔ∏è Parkovisko
            </button>
            <button class="action-button lodging" onclick="findPlaces('hotels and apartments for rent')">
                üè® Ubytovanie
            </button>
            <button class="action-button camping" onclick="findPlaces('campgrounds and RV parks')">
                ‚õ∫ Kempy
            </button>
        </div>

        <p class="status-message" id="status">Vyberte kateg√≥riu, ktor√∫ chcete n√°js≈•.</p>
        
        <div class="pwa-tip">
            <strong>TIP: Pou≈æ√≠vajte ako aplik√°ciu!</strong>
            Pre najr√Ωchlej≈°√≠ pr√≠stup kliknite v prehliadaƒçi na **tri bodky** (‚ãÆ) a zvoƒæte **"Prida≈• na plochu"**. Vytvor√≠te si tak ikonu pre okam≈æit√© spustenie.
        </div>
    </div>

    <script>
        const statusElement = document.getElementById('status');
        const MAX_ACCURACY = 5000; // Maxim√°lna akceptovateƒæn√° nepresnos≈• v metroch (5 km)

        function displayStatus(message) {
            statusElement.textContent = message;
            statusElement.classList.remove('error-message');
        }

        function displayError(message) {
            statusElement.textContent = message;
            statusElement.classList.add('error-message');
        }

        function submitSearch(query, lat, lon) {
            // UNIVERZ√ÅLNY FORM√ÅT: /search/QUERY/@LAT,LON,ZOOMz
            // QUERY je zak√≥dovan√Ω vyhƒæad√°van√Ω term√≠n
            // @LAT,LON,15z zaist√≠ vycentrovanie mapy na zisten√∫ polohu (15z je √∫rove≈à pribl√≠≈æenia)
            
            // Opraven√° URL adresa pre Google Maps
            const mapsUrl = `https://www.google.com/maps/search/${encodeURIComponent(query)}/@${lat},${lon},15z`;
            
            displayStatus(`Otv√°ram Mapy pre ${query}...`);
            // Pou≈æ√≠vame window.open, ktor√© je spoƒæahlivej≈°ie ako formul√°r pre spustenie aplik√°cie Maps
            window.open(mapsUrl, '_blank'); 

            setTimeout(() => {
                // Po 1 sekunde sa vr√°ti p√¥vodn√° spr√°va
                displayStatus('Vyberte kateg√≥riu, ktor√∫ chcete n√°js≈•.'); 
            }, 1000);
        }

        function findPlaces(query) {
            displayStatus(`Zis≈•ujem polohu pre "${query}"... üõ∞Ô∏è`);

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        const accuracy = position.coords.accuracy;
                        const km_accuracy = Math.round(accuracy / 1000); // Pre lep≈°ie zobrazenie

                        // ZOBRAZENIE DEBUG INFORM√ÅCI√ç
                        // Ak je toto Budape≈°≈•, vieme, ≈æe je probl√©m s prehliadaƒçom/OS.
                        displayStatus(`Poloha zisten√°! (Lat: ${lat.toFixed(4)}, Lon: ${lon.toFixed(4)}. Presnos≈•: ¬± ${km_accuracy} km)`);


                        // KONTROLA PRESNOSTI (St√°le ju nech√°vame, ak by sa situ√°cia zmenila)
                        if (accuracy > MAX_ACCURACY) {
                            displayError(`
                                Poloha je pr√≠li≈° nepresn√° (¬± ${km_accuracy} km). 
                                Vyhƒæad√°vanie je pozastaven√©. Pre zlep≈°enie sk√∫ste √≠s≈• von alebo zapn√∫≈• GPS.
                            `);
                            return; // Zastav√≠ vykon√°vanie
                        }

                        // Ak je poloha dostatoƒçne presn√° (alebo falo≈°ne presn√°), pokraƒçujeme
                        submitSearch(query, lat, lon);

                    },
                    (error) => {
                        // Spracovanie ch√Ωb
                        let errorMessage = "Nastala nezn√°ma chyba.";
                        if (error.code === error.PERMISSION_DENIED) {
                            errorMessage = "Pr√≠stup k polohe zamietnut√Ω. Povoƒæte polohu v nastaveniach prehliadaƒça.";
                        } else if (error.code === error.POSITION_UNAVAILABLE) {
                            errorMessage = "Inform√°cie o polohe nie s√∫ dostupn√©. Sk√∫ste to znova nesk√¥r.";
                        } else if (error.code === error.TIMEOUT) {
                            errorMessage = "Vypr≈°al ƒçasov√Ω limit (5 sek√∫nd). Sk√∫ste to znova.";
                        }
                        displayError(`Chyba: ${errorMessage}`);
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 5000,
                        maximumAge: 0
                    }
                );
            } else {
                displayError("V√°≈° prehliadaƒç nepodporuje geolok√°ciu.");
            }
        }
    </script>
</body>
</html>
